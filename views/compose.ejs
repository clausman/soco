<script src="/js/libs/music.js"></script>


<!-- Audiolet.js -->
<script type="text/javascript" src="https://ajax.googleapis.com/ajax/libs/mootools/1.3.2/mootools-yui-compressed.js"></script>

<script src="/js/libs/audiolet/Audiolet.js"></script>
<script src="/js/libs/audiolet/audiolet_app.js"></script>
<script>
    var compositions = <%-data.compositions%>;
    var sidebar = dojo.byId("sidebar");
    var ul = (document.createElement("ul"));
    ul.className = "nav";
    dojo.forEach(compositions, function(item) {
        var li = document.createElement("li");
        li.innerHTML = item.key;
        dojo.place(li, ul);
    });
    
    dojo.place(ul, sidebar);
</script>

<input value="Play" type="button" onclick="window.pianoRoll.playAll()"></input>
<script>
    _timeSteps = { "1/16": 10, "1/8": 20, "1/4": 40, "1/2": 80, "1": 160 }, // the breakdown of tempo - 1/16, 1/8, 1/4, 1/2, 1 step


    require(["dojo/ready", "widgets/PianoRoll"], function (ready, PianoRoll) {
        ready(function () {
            setTimeout(dojo.hitch(this,
                function () {
                    window.pianoRoll = new widgets.PianoRoll({ timeStep: _timeSteps["1/4"] });
                    window.pianoRoll.placeAt("content");
                }), 5);
        });
    });
</script>